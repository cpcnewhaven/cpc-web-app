{% extends "base_glass.html" %}

{% block title %}CPC New Haven - Dashboard{% endblock %}

{% block content %}
<!-- Dashboard Header -->
<section class="dashboard-header">
    <div class="welcome-widget">
        <h1>Welcome to CPC New Haven</h1>
        <p>Growing in the truth and grace of Jesus Christ, acting as a faithful witness in the greater New Haven community and world, trusting in the grace and power of the Holy Spirit.</p>
        <div class="quick-actions">
            <a href="{{ url_for('sundays') }}" class="btn-glass btn-glass-primary">
                <i class="fas fa-calendar-alt"></i> Join Us This Sunday
            </a>
            <a href="{{ url_for('about') }}" class="btn-glass">
                <i class="fas fa-info-circle"></i> Learn More
            </a>
        </div>
    </div>
</section>

<!-- Dashboard Grid -->
<div class="dashboard-grid">
    <!-- Service Times Widget -->
    <div class="dashboard-widget service-times-widget">
        <div class="widget-header">
            <h3><i class="fas fa-clock"></i> Service Times</h3>
        </div>
        <div class="widget-content">
            <div class="service-item">
                <div class="service-time">10:30 AM</div>
                <div class="service-name">Sunday Worship</div>
                <div class="service-desc">Join us for worship, preaching, and communion</div>
            </div>
            <div class="service-item">
                <div class="service-time">9:30 AM</div>
                <div class="service-name">Sunday School</div>
                <div class="service-desc">Children's and Adult Bible Studies</div>
            </div>
            <div class="service-item">
                <div class="service-time">12:00 PM</div>
                <div class="service-name">Fellowship Lunch</div>
                <div class="service-desc">Stay for community after worship</div>
            </div>
        </div>
    </div>

    <!-- Featured Announcements Widget -->
    {% if superfeatured %}
    <div class="dashboard-widget announcements-widget">
        <div class="widget-header">
            <h3><i class="fas fa-bullhorn"></i> Featured Announcements</h3>
            <a href="{{ url_for('announcements') }}" class="widget-link">View All</a>
        </div>
        <div class="widget-content">
            {% for announcement in superfeatured %}
            <div class="announcement-item">
                {% if announcement.featured_image %}
                <div class="announcement-image" style="background-image: url('{{ announcement.featured_image }}');"></div>
                {% endif %}
                <div class="announcement-content">
                    <h4>{{ announcement.title }}</h4>
                    <p>{{ announcement.description[:100] }}{% if announcement.description|length > 100 %}...{% endif %}</p>
                    <span class="announcement-category">{{ announcement.category|title }}</span>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Recent Sermons Widget -->
    {% if recent_sermons %}
    <div class="dashboard-widget sermons-widget">
        <div class="widget-header">
            <h3><i class="fas fa-microphone"></i> Recent Sermons</h3>
            <a href="{{ url_for('sermons') }}" class="widget-link">View All</a>
        </div>
        <div class="widget-content">
            {% for sermon in recent_sermons %}
            <div class="sermon-item">
                {% if sermon.podcast_thumbnail_url %}
                <div class="sermon-image" style="background-image: url('{{ sermon.podcast_thumbnail_url }}');"></div>
                {% endif %}
                <div class="sermon-content">
                    <h4>{{ sermon.title }}</h4>
                    <p class="sermon-author">{{ sermon.author }}</p>
                    {% if sermon.scripture %}
                    <p class="sermon-scripture">{{ sermon.scripture }}</p>
                    {% endif %}
                    <p class="sermon-date">{{ sermon.date }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Upcoming Events Widget -->
    <div class="dashboard-widget events-widget">
        <div class="widget-header">
            <h3><i class="fas fa-calendar"></i> Upcoming Events</h3>
            <a href="{{ url_for('events') }}" class="widget-link">View All</a>
        </div>
        <div class="widget-content">
            <div class="event-item">
                <div class="event-time">Every Sunday</div>
                <div class="event-name">Prayer in the Parlor</div>
                <div class="event-desc">8:30 AM - Join us for prayer</div>
            </div>
            <div class="event-item">
                <div class="event-time">Wednesdays</div>
                <div class="event-name">Bible Study</div>
                <div class="event-desc">7:00 PM - Weekly Bible study</div>
            </div>
            <div class="event-item">
                <div class="event-time">Saturdays</div>
                <div class="event-name">Men's Fellowship</div>
                <div class="event-desc">8:00 AM - Men's fellowship group</div>
            </div>
        </div>
    </div>

    <!-- Quick Links Widget -->
    <div class="dashboard-widget quick-links-widget">
        <div class="widget-header">
            <h3><i class="fas fa-link"></i> Quick Links</h3>
        </div>
        <div class="widget-content">
            <div class="quick-links-grid">
                <a href="{{ url_for('podcasts') }}" class="quick-link">
                    <i class="fas fa-podcast"></i>
                    <span>Podcasts</span>
                </a>
                <a href="{{ url_for('events') }}" class="quick-link">
                    <i class="fas fa-calendar"></i>
                    <span>Events</span>
                </a>
                <a href="{{ url_for('community') }}" class="quick-link">
                    <i class="fas fa-users"></i>
                    <span>Community</span>
                </a>
                <a href="{{ url_for('live') }}" class="quick-link">
                    <i class="fas fa-video"></i>
                    <span>Live Stream</span>
                </a>
                <a href="{{ url_for('resources') }}" class="quick-link">
                    <i class="fas fa-book"></i>
                    <span>Resources</span>
                </a>
                <a href="{{ url_for('give') }}" class="quick-link">
                    <i class="fas fa-heart"></i>
                    <span>Give</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Contact Widget -->
    <div class="dashboard-widget contact-widget">
        <div class="widget-header">
            <h3><i class="fas fa-map-marker-alt"></i> Visit Us</h3>
        </div>
        <div class="widget-content">
            <div class="contact-info">
                <p><strong>135 Whitney Ave</strong></p>
                <p>New Haven, CT 06510</p>
                <p>Phone: (203) 555-0123</p>
                <p>Email: admin@cpcnewhaven.org</p>
            </div>
            <div class="contact-actions">
                <a href="https://maps.google.com" class="btn-glass" target="_blank">
                    <i class="fas fa-directions"></i> Get Directions
                </a>
                <a href="mailto:admin@cpcnewhaven.org" class="btn-glass">
                    <i class="fas fa-envelope"></i> Contact Us
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('CPC New Haven dashboard loaded');
    
    // Animate widgets on scroll
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);
    
    // Observe all dashboard widgets
    document.querySelectorAll('.dashboard-widget').forEach(el => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px)';
        el.style.transition = 'all 0.6s ease-out';
        observer.observe(el);
    });
});
</script>
{% endblock %}